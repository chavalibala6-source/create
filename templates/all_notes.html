<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All Notes</title>

<style>
  /* Modal Background */
  .modal {
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow-y: auto;
    background-color: rgba(0,0,0,0.6);
    padding: 60px 20px; /* more mobile-friendly */
  }
  
  /* Modal Box */
  .modal-content {
    background-color: #fff;
    margin: auto;
    padding: 25px;
    border-radius: 16px;
    width: 100%;
    max-width: 800px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.25);
    animation: fadeIn 0.3s ease;
  }
  
  /* Close Button */
  .close {
    color: #333;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }
  .close:hover {
    color: #0071e3;
  }
  
  /* Animation */
  @keyframes fadeIn {
    from {opacity: 0; transform: translateY(-15px);}
    to {opacity: 1; transform: translateY(0);}
  }

  /* General Body */
  body {
    font-family: 'Inter', Arial, sans-serif;
    background: #f5f5f7;
    margin: 0;
    padding: 0;
    color: #1c1c1e;
  }
/* Give main content padding, not body */
main {
  padding: 40px 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
}
* {
  box-sizing: border-box;
}
  h1 {
    font-weight: 600;
    font-size: 2em;
    margin: 30px 0;
  }

  /* Navbar Styles */
  .navbar {
  width: 100%;
  max-width: 100vw;
  margin: 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 40px;
  background-color: #fff;
  box-shadow: 0 2px 12px rgba(0,0,0,0.06);
  position: sticky;
  top: 0;
  z-index: 1000;
}
.navbar .logo {
    font-weight: 700;
    font-size: 1.5em;
    color: #0071e3;
    text-decoration: none;
    letter-spacing: -0.5px;
  }
  .navbar ul {
    list-style: none;
    display: flex;
    margin: 0;
    padding: 0;
  }
  .navbar ul li {
    margin-left: 25px;
  }
  .navbar ul li a {
    text-decoration: none;
    color: #1c1c1e;
    font-weight: 500;
    transition: color 0.3s;
  }
  .navbar ul li a:hover {
    color: #0071e3;
  }

  /* Notes Grid */
  .notes-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 20px;
    width: 100%;
    max-width: 1100px;
  }

  .note-card {
    background: #fff;
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    position: relative;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .note-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.15);
  }

  .note-header {
    display: flex;
    justify-content: space-between; /* FIXED: no more fixed width */
    align-items: center;
    margin-bottom: 12px;
    font-size: 0.9em;
    color: #666;
  }

  .note-title {
    font-weight: 600;
    font-size: 1.2em;
    margin-bottom: 10px;
    text-align: center;
    padding: 8px;
    background: #f4f4f4;
    border-radius: 8px;
  }

  note-content {
  font-size: 0.95em;
  line-height: 1.5;
  color: #333;
  max-height: 150px;
  overflow: hidden;
  transition: max-height 0.3s ease;
  word-wrap: break-word;   /* break long words */
  overflow-wrap: break-word;
}

.note-content.expanded {
  max-height: none; /* let it expand fully */
  overflow-x: auto; /* if content is too wide, scroll inside */
}

/* Keep images/tables/code inside container */
.note-content img,
.note-content table,
.note-content pre,
.note-content code {
  max-width: 100%;
  overflow-x: auto;
  display: block;
  box-sizing: border-box;
}

/* Modal body same rule */
#modal-body {
  word-wrap: break-word;
  overflow-wrap: break-word;
}
#modal-body img,
#modal-body table,
#modal-body pre,
#modal-body code {
  max-width: 100%;
  overflow-x: auto;
  display: block;
}

  .note-actions {
    margin-top: 15px;
    text-align: right;
  }
  .note-actions button,
  .note-actions a {
    font-size: 14px;
    border: none;
    background: none;
    cursor: pointer;
    color: #0071e3;
    margin-left: 10px;
  }
  .note-actions button:hover,
  .note-actions a:hover {
    text-decoration: underline;
  }

  /* Responsive Fix */
  @media (max-width: 600px) {
    h1 { font-size: 1.5em; }
    .navbar { padding: 10px 15px; }
    .note-card { padding: 15px; }
  }
</style>
</head>
<body>
  <nav class="navbar">
    <a href="/" class="logo">MyNotes</a>
    <ul>
      <li><a href="/">All Notes</a></li>
      <li><a href="/paper">Create Note</a></li>
    </ul>
  </nav>

  <!-- Modal -->
  <div id="noteModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h2 id="modal-title"></h2>
      <div id="modal-body"></div>
    </div>
  </div>
  <main>
  <h1>ðŸ“’ All Notes</h1>

  <div class="notes-list">
    {% for note in notes %}
    <div class="note-card">
      <div class="note-header">
        <span>ðŸ“„ Page {{ note.page_number }}</span>
        <span>{{ note.timestamp }}</span>
      </div>
      <div class="note-title">{{ note.title }}</div>
      <div class="note-content" id="content-{{ note.page_number }}">
        {{ note.text|safe }}
      </div>
      <div class="note-actions">
        <button onclick="toggleContent('{{ note.page_number }}')">Expand</button>
        <a href="/paper?page={{ note.page_number }}">Open</a>
        <a href="/delete?page={{ note.page_number }}" onclick="return confirm('Are you sure you want to delete this note?')">Delete</a>
      </div>
    </div>
    {% endfor %}
  </div>
</main>
  <script>
  function toggleContent(pageNumber) {
    const title = document.querySelector(`#content-${pageNumber}`).previousElementSibling.innerText;
    const body = document.getElementById('content-' + pageNumber).innerHTML;
  
    document.getElementById('modal-title').innerText = title;
    document.getElementById('modal-body').innerHTML = body;
  
    document.getElementById('noteModal').style.display = 'block';
  }
  
  function closeModal() {
    document.getElementById('noteModal').style.display = 'none';
  }
  
  // Close modal if background is clicked
  window.onclick = function(event) {
    const modal = document.getElementById('noteModal');
    if (event.target === modal) {
      closeModal();
    }
  }
  </script>
</body>
</html>
